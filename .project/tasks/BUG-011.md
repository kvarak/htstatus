# [BUG-011] Player Blueprint NoneType User Crash

**Status**: ðŸŽ¯ Ready to Execute | **Effort**: 30-45 minutes | **Priority**: P1 | **Impact**: Critical test failure blocking development
**Dependencies**: None | **Strategic Value**: Essential for test reliability

## Problem Statement
Player blueprint tests are failing with `AttributeError: 'NoneType' object has no attribute 'last_update'` when the user query returns None but code attempts to access user.last_update without null checking.

**Error Details**:
- Location: `app/blueprints/player.py:288` in `player()` function
- Pattern: 7 out of 17 tests failing with identical error
- Root cause: `user = db.session.query(User).filter_by(ht_id=session["current_user_id"]).first()` returns None
- Impact: 41% test failure rate in player blueprint

**Test Failures**:
- `test_player_route_valid_team_id`
- `test_player_route_no_team_id_uses_form`
- `test_player_display_with_training_data`
- `test_player_skill_calculations`
- `test_player_database_error_handling`
- `test_debug_printing`
- `test_player_data_processing`

## Implementation
1. **Null Check for User Query** (15 min):
   - Add null check after user query on line 214
   - Provide default value or graceful error handling for missing user
   - Consider using `User.getColumns(user)` pattern which may already handle None

2. **Test Environment Fix** (15 min):
   - Verify test fixtures properly create user records
   - Ensure authenticated_client setup includes proper user creation
   - Check session state initialization in test setup

3. **Defensive Programming** (15 min):
   - Add similar null checks throughout player blueprint
   - Document user query patterns for consistency
   - Consider helper function for safe user access

## Acceptance Criteria
- All 17 player blueprint tests pass (100% success rate)
- No AttributeError crashes for missing users
- Graceful handling of edge cases (missing user, invalid session)
- Test coverage maintained or improved
- Code patterns documented for future use

## Scout Mindset Opportunities
- Review other blueprints for similar null pointer risks
- Standardize user query patterns across application
- Improve error handling consistency
- Clean up any nearby code quality issues found